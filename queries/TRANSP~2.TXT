WITH RAWDATA (INC_NO, TRAV_TIME, TRANS_CD) AS (
SELECT	P.INCIDENT_CD  AS INC_NO,  TIMESTAMPDIFF (2, CAST((TIMESTAMP(DPTSCN_DATE, DPTSCN_TIME)) - 
		       TIMESTAMP(ARVDST_DATE, ARVDST_TIME) AS CHAR(22))) AS TRAVTIME,
	I.APCTRANSPORT AS TRANS_CD
FROM	FACCSDB.INCIDENTS1 I, FACCSDB.INCIDENT_UNITS1 U, FACCSDB.PATIENTS1 P, FACCSDB.DIAGCODES D
WHERE	P.DIAG_CD IN D.DIAG_CD	AND
	P.INCIDENT_CD = I.INCIDENT_CD	AND
	U.INCIDENT_CD = I.INCIDENT_CD	AND
	U.DISP_DATE BETWEEN :STARTDATE AND :ENDDATE),

minutes (min_col) as
(
select min_col from faccsdb.minutes
)


select 	min_col,
	cast((select count(*) from RAWDATA where cast(TRAV_TIME as float) < 60* min_col) as float) / (cast((select count(*) from RAWDATA where TRAV_TIME is not null) as float)) as Travel_Time
from	RAWDATA, minutes
group by 	min_col