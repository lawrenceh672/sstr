SELECT cast(d.diag_cd as integer), cast (pr.proc_cd as integer) as Proc_cd, count(*) as Count

FROM FACCSDB.PROCEDURES PR,
FACCSDB.PATIENTS1 PS,
FACCSDB.DIAGNOSIS D,
FACCSDB.INCIDENTS1 I

WHERE PR.LICENSENO = '3278' AND
PS.PATIENT_CD = PR.PATIENT_CD AND
PS.INCIDENT_CD = PR.INCIDENT_CD AND
PS.DIAG_CD = D.DIAG_CD AND
I.INCIDENT_CD = PS.INCIDENT_CD AND
I.CREATE_DATE BETWEEN DATE('01/31/1998') AND DATE('07/05/1999')
group by PR.PROC_CD, D.DIAG_CD
order by 1,3